<!DOCTYPE html>
<title>[e]mergences</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<head>
    <style>
        .but {
            width: 100%;
            height: 100%;
            /* display: inline-block; */
        }
        
        body {
            background-color: black;
            font-family: Monospace;
            margin: 0px;
            overflow: hidden;
        }
        
        canvas {
            display: block;
        }
        
        details {
            position: absolute;
            left: 10px;
            top: 10px;
        }
        
        .left,
        details {
            z-index: 90;
        }
        
        .left {
            display: fixed;
            flex-flow: column wrap;
        }
        
        .oscillator {
            background-color: rgba(255, 255, 255, 0.75);
            box-shadow: 0px 0px 5px rgb(200, 200, 200);
            margin: 5px;
            padding: 5px;
            background-image: -webkit-linear-gradient(90deg, rgb(165, 0, 0), rgb(102, 95, 63));
            background-image: -moz-linear-gradient(90deg, rgb(165, 0, 0), #FFEDBC);
            background-image: -o-linear-gradient(90deg, rgb(165, 0, 0), #FFEDBC);
        }
        
        .frequency,
        .damping,
        .amplitude,
        .phase {
            font-size: 10px;
            padding: 12px;
        }
        
        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 5px;
            border-radius: 5px;
            background: #000000;
            outline: none;
            opacity: 0.5;
            -webkit-transition: .2s;
            transition: opacity .2s;
        }
        
        .slider:hover {
            opacity: 1;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: hsl(0, 44%, 25%);
            border: 2px solid rgb(255, 0, 0);
            cursor: pointer;
            opacity: 0.9;
        }
        
        .slider::-moz-range-thumb {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: rgb(53, 12, 12);
            cursor: pointer;
        }
        
        .summary {
            width: 200px;
            font-size: 10px;
            /*padding: 20px;*/
        }
        
        .scene-container {
            background-color: rgb(255, 255, 255);
            display: block;
        }
        
        #likebut {
            /* shadow */
            font-family: 'Helvetica', 'Arial', sans-serif;
            display: inline-block;
            font-size: 10px;
            padding: 10px;
            margin-top: 15px;
            margin-left: 5%;
            margin-bottom: 25px;
            width: 90%;
            appearance: none;
            background-image: linear-gradient(90deg, rgb(255, 169, 169), #FFEDBC);
            border-radius: 5px;
        }
        
        *:focus {
            outline: 0 !important;
        }
    </style>

    <div class="container">
        <div class="col1">
            <!-- <button class="but" onclick="startClicked()"> Start </button> -->
            <!-- <button class="but" onclick="stopClicked()"> Stop </button> -->
            <template class="oscillator-template">
                <div class="oscillator" id="oscillator">

                    <div class="frequency">
                        <div>Frequency: <text></text>Hz</div>
                        <input type="range" id="freq" min="1" max="30" step=".001" class="slider" />
                    </div>
                    <div class="damping">
                        <div>Damping: <text></text></div>
                        <input type="range" id="damp" min="-0.004" max="0.02" step="0.001" value="0.001"
                            class="slider" />
                    </div>
                    <div class="amplitude">
                        <div>Amplitude: <text></text>%</div>
                        <input type="range" id="amp" value="100" class="slider" />
                    </div>
                    <div class="phase">
                        <div>Phase Rate: <text></text>%</div>
                        <input type="range" id="phase" value="0" class="slider" />
                    </div>

                    <button id="likebut">Like</button>

                </div>
            </template>
        </div>
        <div class="oscillator-container">
            <details open ontoggle="toggleDetails(this)">
                <summary class="oscillator summary">Hide Oscillator</summary>
                <div class="left"></div>
            </details>

            <div class="scene-container"></div>
        </div>
        <script>
            document.querySelector(".left").style.height = innerHeight * 0.9 + "px";

            ///////////////////////////////////////////////////////////////////////////////
            // global variables
            ///////////////////////////////////////////////////////////////////////////////

            let count = 40000;
            let t = 0;
            let paused = false;
            let freeze = false;

            ///////////////////////////////////////////////////////////////////////////////
            // create the oscillators using Oscillator() as a constructor
            ///////////////////////////////////////////////////////////////////////////////

            const template = document
                .querySelector(".oscillator-template")
                .content.querySelector(".oscillator");

            const oscillators = [];
            oscillators.push(Oscillator());

            ///////////////////////////////////////////////////////////////////////////////
            // for creating the oscillators and storing their values in a central location
            ///////////////////////////////////////////////////////////////////////////////

            function Oscillator() {
                const newOscillator = document.importNode(template, true);

                const self = {};

                // frequency
                const fInput = newOscillator.querySelector(".frequency input");
                const fText = newOscillator.querySelector(".frequency text");
                self.f = fInput.value = Math.ceil(Math.random() * 10);
                fText.innerHTML = self.f * 100;


                fInput.oninput = function() {
                    self.f = +this.value;
                    fText.innerHTML = Math.ceil(self.f * 100);
                    // console.log(self.f);
                    t = 0;

                };

                // damping
                const dInput = newOscillator.querySelector(".damping input");
                const dText = newOscillator.querySelector(".damping text");
                self.d = dText.innerHTML = +dInput.value;

                dInput.oninput = function() {
                    self.d = dText.innerHTML = +this.value;
                    t = 0;

                };

                // amplitude
                const aInput = newOscillator.querySelector(".amplitude input");
                const aText = newOscillator.querySelector(".amplitude text");
                self.a = aText.innerHTML = +aInput.value;


                aInput.oninput = function() {
                    self.a = aText.innerHTML = +this.value;
                    t = 0;

                };

                // phase
                const pInput = newOscillator.querySelector(".phase input");
                const pText = newOscillator.querySelector(".phase text");
                self.p = +pInput.value;
                pText.innerHTML = self.p;

                self.offsetText = newOscillator.querySelector(".offset text");
                self.offset = 0;

                pInput.oninput = function() {
                    self.p = +this.value;
                    pText.innerHTML = self.p;

                };
                document.querySelector(".left").appendChild(newOscillator);
                return self;
            }


            function toggleDetails(self) {
                self.children[0].innerHTML = self.open ?
                    "Hide Oscillator" :
                    "Show Oscillator";
            }
        </script>

</head>